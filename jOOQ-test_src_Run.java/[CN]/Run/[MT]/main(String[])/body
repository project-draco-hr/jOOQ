{
  Connection connection=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","TEST","TEST");
  Factory create=new OracleFactory(connection);
  System.out.println(create.fetch("with data as (" + " select 'Lukas'      as employee," + "       'SoftSkills' as company, "+ "       80000        as salary, "+ "       2007         as year "+ " from dual"+ " union all select 'Lukas', 'SoftSkills', 80000,  2008 from dual"+ " union all select 'Lukas', 'SmartSoft',  90000,  2009 from dual"+ " union all select 'Lukas', 'SmartSoft',  95000,  2010 from dual"+ " union all select 'Lukas', 'jOOQ',       200000, 2011 from dual"+ " union all select 'Lukas', 'jOOQ',       250000, 2012 from dual"+ " union all select 'Tom',   'SoftSkills', 89000,  2007 from dual"+ " union all select 'Tom',   'SoftSkills', 90000,  2008 from dual"+ " union all select 'Tom',   'SoftSkills', 91000,  2009 from dual"+ " union all select 'Tom',   'SmartSoft',  92000,  2010 from dual"+ " union all select 'Tom',   'SmartSoft',  93000,  2011 from dual"+ " union all select 'Tom',   'SmartSoft',  94000,  2012 from dual"+ " )"+ " select grouping_id(employee, company) id, company, employee, avg(salary)"+ " from data"+ " group by cube(employee, company)"));
}
