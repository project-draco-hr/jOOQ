{
  for (  Record record : create().select(concat(References.TABNAME,val("__"),References.CONSTNAME).as("constraint_name"),References.TABSCHEMA.trim(),References.TABNAME,References.FK_COLNAMES,concat(References.REFTABNAME,val("__"),References.REFKEYNAME).as("referenced_constraint_name"),References.REFTABSCHEMA.trim()).from(REFERENCES).where(References.TABSCHEMA.in(getInputSchemata())).orderBy(References.TABSCHEMA,References.TABNAME,References.CONSTNAME,References.FK_COLNAMES).fetch()) {
    SchemaDefinition foreignKeySchema=getSchema(record.getValue(References.TABSCHEMA.trim()));
    SchemaDefinition uniqueKeySchema=getSchema(record.getValue(References.REFTABSCHEMA.trim()));
    String foreignKey=record.getValue("constraint_name",String.class);
    String foreignKeyTableName=record.getValue(References.TABNAME);
    String foreignKeyColumn=record.getValue(References.FK_COLNAMES);
    String uniqueKey=record.getValue("referenced_constraint_name",String.class);
    TableDefinition foreignKeyTable=getTable(foreignKeySchema,foreignKeyTableName);
    if (foreignKeyTable != null) {
      String[] referencingColumnNames=foreignKeyColumn.trim().split("[ ]+");
      for (int i=0; i < referencingColumnNames.length; i++) {
        ColumnDefinition column=foreignKeyTable.getColumn(referencingColumnNames[i]);
        relations.addForeignKey(foreignKey,uniqueKey,column,uniqueKeySchema);
      }
    }
  }
}
