{
  if (value == null) {
    stream.writeObject(null);
  }
 else   if (type == Blob.class) {
    stream.writeBlob((Blob)value);
  }
 else   if (type == Boolean.class) {
    stream.writeBoolean((Boolean)value);
  }
 else   if (type == BigInteger.class) {
    stream.writeBigDecimal(new BigDecimal((BigInteger)value));
  }
 else   if (type == BigDecimal.class) {
    stream.writeBigDecimal((BigDecimal)value);
  }
 else   if (type == Byte.class) {
    stream.writeByte((Byte)value);
  }
 else   if (type == byte[].class) {
    if (dataType.isLob()) {
      Blob blob=null;
      try {
        blob=on("oracle.sql.BLOB").call("createTemporary",on(stream).call("getSTRUCT").call("getJavaSqlConnection").get(),false,on("oracle.sql.BLOB").get("DURATION_SESSION")).get();
        blob.setBytes(1,(byte[])value);
        stream.writeBlob(blob);
      }
  finally {
        DefaultExecuteContext.register(blob);
      }
    }
 else {
      stream.writeBytes((byte[])value);
    }
  }
 else   if (type == Clob.class) {
    stream.writeClob((Clob)value);
  }
 else   if (type == Date.class) {
    stream.writeDate((Date)value);
  }
 else   if (type == Double.class) {
    stream.writeDouble((Double)value);
  }
 else   if (type == Float.class) {
    stream.writeFloat((Float)value);
  }
 else   if (type == Integer.class) {
    stream.writeInt((Integer)value);
  }
 else   if (type == Long.class) {
    stream.writeLong((Long)value);
  }
 else   if (type == Short.class) {
    stream.writeShort((Short)value);
  }
 else   if (type == String.class) {
    if (dataType.isLob()) {
      Clob clob=null;
      try {
        clob=on("oracle.sql.CLOB").call("createTemporary",on(stream).call("getSTRUCT").call("getJavaSqlConnection").get(),false,on("oracle.sql.CLOB").get("DURATION_SESSION")).get();
        clob.setString(1,(String)value);
        stream.writeClob(clob);
      }
  finally {
        DefaultExecuteContext.register(clob);
      }
    }
 else {
      stream.writeString((String)value);
    }
  }
 else   if (type == Time.class) {
    stream.writeTime((Time)value);
  }
 else   if (type == Timestamp.class) {
    stream.writeTimestamp((Timestamp)value);
  }
 else   if (type == YearToMonth.class) {
    stream.writeString(value.toString());
  }
 else   if (type == DayToSecond.class) {
    stream.writeString(value.toString());
  }
 else   if (UNumber.class.isAssignableFrom(type)) {
    stream.writeString(value.toString());
  }
 else   if (ArrayRecord.class.isAssignableFrom(type)) {
    Connection connection=DefaultExecuteContext.registeredConfiguration().getConnectionProvider().acquire();
    ArrayRecord<?> arrayRecord=(ArrayRecord<?>)value;
    stream.writeArray(on(connection).call("createARRAY",arrayRecord.getName(),arrayRecord.get()).<Array>get());
  }
 else   if (EnumType.class.isAssignableFrom(type)) {
    stream.writeString(((EnumType)value).getLiteral());
  }
 else   if (UDTRecord.class.isAssignableFrom(type)) {
    stream.writeObject((UDTRecord<?>)value);
  }
 else {
    throw new UnsupportedOperationException("Type " + type + " is not supported");
  }
}
