{
  if (foreignKey.getReferencedColumns().size() != foreignKey.getKeyColumns().size()) {
    log.warn("Foreign key mismatch",foreignKey.getName() + " does not match its primary key! No code is generated for this key. See trac tickets #64 and #69");
    return;
  }
  final TableDefinition referenced=foreignKey.getReferencedTable();
  final TableDefinition referencing=foreignKey.getKeyTable();
  final String referencedId=getStrategy().getFullJavaIdentifier(referenced);
  final String referencedType=getStrategy().getFullJavaClassName(referenced,Mode.RECORD);
  final String referencedClassName=getStrategy().getJavaClassName(referenced);
  List<String> disambiguation=list(foreignKey.countSimilarReferences() > 1 ? getStrategy().getJavaClassName(column) : null);
  out.tab(1).javadoc("Fetch a record from <code>%s</code> referenced from <code>%s</code> through <code>%s</code>",referenced.getQualifiedOutputName(),referencing.getQualifiedOutputName(),foreignKey.getQualifiedOutputName());
  out.tab(1).println("public %s fetch%s[[before=By][%s]]() {",referencedType,referencedClassName,disambiguation);
  out.tab(2).println("return create()");
  out.tab(3).println(".selectFrom(%s)",referencedId);
  String connector="where";
  for (int i=0; i < foreignKey.getReferencedColumns().size(); i++) {
    final String ukId=getStrategy().getFullJavaIdentifier(foreignKey.getReferencedColumns().get(i));
    final String fkId=getStrategy().getFullJavaIdentifier(foreignKey.getKeyColumns().get(i));
    DataTypeDefinition foreignType=foreignKey.getKeyColumns().get(i).getType();
    DataTypeDefinition primaryType=foreignKey.getReferencedColumns().get(i).getType();
    List<String> conversion=list(!match(foreignType,primaryType) ? getSimpleJavaType(foreignKey.getReferencedColumns().get(i).getType()) : null);
    out.tab(3).println(".%s(%s.equal(getValue(%s[[before=, ][after=.class][%s]])))",connector,ukId,fkId,conversion);
    connector="and";
  }
  out.println("\t\t\t.fetchOne();");
  out.println("\t}");
}
