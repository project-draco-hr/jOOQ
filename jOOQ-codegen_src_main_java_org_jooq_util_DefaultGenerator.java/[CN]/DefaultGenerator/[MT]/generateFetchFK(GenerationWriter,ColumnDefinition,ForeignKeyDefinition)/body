{
  if (foreignKey.getReferencedColumns().size() != foreignKey.getKeyColumns().size()) {
    log.warn("Foreign key mismatch",foreignKey.getName() + " does not match its primary key! No code is generated for this key. See trac tickets #64 and #69");
    return;
  }
  TableDefinition referenced=foreignKey.getReferencedTable();
  if (referenced instanceof MasterDataTableDefinition) {
    return;
  }
  printFieldJavaDoc(out,column);
  out.print("\tpublic ");
  out.print(strategy.getFullJavaClassName(referenced,Mode.RECORD));
  out.print(" fetch");
  out.print(strategy.getJavaClassName(referenced));
  if (foreignKey.countSimilarReferences() > 1) {
    out.print("By");
    out.print(strategy.getJavaClassName(column));
  }
  out.println("() {");
  out.println("\t\treturn create()");
  out.print("\t\t\t.selectFrom(");
  out.print(strategy.getFullJavaIdentifier(referenced));
  out.println(")");
  String connector="\t\t\t.where(";
  for (int i=0; i < foreignKey.getReferencedColumns().size(); i++) {
    out.print(connector);
    out.print(strategy.getFullJavaIdentifier(foreignKey.getReferencedColumns().get(i)));
    out.print(".equal(getValue");
    DataTypeDefinition foreignType=foreignKey.getKeyColumns().get(i).getType();
    DataTypeDefinition primaryType=foreignKey.getReferencedColumns().get(i).getType();
    if (!match(foreignType,primaryType)) {
      out.print("As");
      out.print(getSimpleJavaType(foreignKey.getReferencedColumns().get(i).getType()));
    }
    out.print("(");
    out.print(strategy.getFullJavaIdentifier(foreignKey.getKeyColumns().get(i)));
    out.println(")))");
    connector="\t\t\t.and(";
  }
  out.println("\t\t\t.fetchOne();");
  out.println("\t}");
}
