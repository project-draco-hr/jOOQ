{
  if (configuration != null) {
    Connection connection=configuration.getConnection();
    if (connection != null) {
      if (connection.getClass() == ConnectionProxy.class) {
        connection=((ConnectionProxy)connection).getDelegate();
      }
      return connection;
    }
  }
  throw new DataAccessException("Cannot get a JDBC driver connection from configuration: " + configuration);
}
