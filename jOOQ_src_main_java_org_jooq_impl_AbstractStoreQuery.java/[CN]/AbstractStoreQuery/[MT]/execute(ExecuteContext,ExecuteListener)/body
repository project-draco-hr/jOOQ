{
  if (returning.isEmpty()) {
    return super.execute(ctx,listener);
  }
 else {
    int result=1;
    ResultSet rs;
switch (ctx.configuration().dialect().family()) {
case SQLITE:
{
        listener.executeStart(ctx);
        result=ctx.statement().executeUpdate();
        listener.executeEnd(ctx);
        DSLContext create=DSL.using(ctx.configuration());
        returned=create.select(returning).from(getInto()).where(rowid().equal(rowid().getDataType().convert(create.lastID()))).fetchInto(getInto());
        return result;
      }
case CUBRID:
case SYBASE:
{
      listener.executeStart(ctx);
      result=ctx.statement().executeUpdate();
      listener.executeEnd(ctx);
      selectReturning(ctx.configuration(),create(ctx.configuration()).lastID());
      return result;
    }
case ASE:
case DERBY:
case H2:
case INGRES:
case MYSQL:
case SQLSERVER:
{
    listener.executeStart(ctx);
    result=ctx.statement().executeUpdate();
    listener.executeEnd(ctx);
    rs=ctx.statement().getGeneratedKeys();
    try {
      List<Object> list=new ArrayList<Object>();
      if (rs != null) {
        while (rs.next()) {
          list.add(rs.getObject(1));
        }
      }
      selectReturning(ctx.configuration(),list.toArray());
      return result;
    }
  finally {
      JDBCUtils.safeClose(rs);
    }
  }
case FIREBIRD:
case POSTGRES:
{
  listener.executeStart(ctx);
  rs=ctx.statement().executeQuery();
  listener.executeEnd(ctx);
  break;
}
case DB2:
case HSQLDB:
case ORACLE:
default :
{
listener.executeStart(ctx);
result=ctx.statement().executeUpdate();
listener.executeEnd(ctx);
rs=ctx.statement().getGeneratedKeys();
break;
}
}
ExecuteContext ctx2=new DefaultExecuteContext(ctx.configuration());
ExecuteListener listener2=new ExecuteListeners(ctx2);
ctx2.resultSet(rs);
returned=new CursorImpl<R>(ctx2,listener2,fieldArray(returning),null,false,true).fetch().into(getInto());
return result;
}
}
