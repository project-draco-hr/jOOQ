{
  while (true) {
    int instanceID=nextInstanceID++;
    if (!instanceIDToObjectReferenceMap.containsKey(instanceID)) {
      if (o == null) {
        return instanceID;
      }
      instanceIDToObjectReferenceMap.put(instanceID,new WeakReference<Object>(o));
      startThread();
      return instanceID;
    }
  }
}
