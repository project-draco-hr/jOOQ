{
  if (context.declareFields() || context.declareTables()) {
    SQLDialect dialect=context.getDialect();
    boolean simulateDerivedColumnList=asList(ORACLE).contains(dialect);
    if (fieldAliases != null && simulateDerivedColumnList) {
      context.keyword("(with").sql(" v");
      toSQLDerivedColumnList(context);
      context.keyword(" as (select * from ").sql(wrapped).sql(") ").keyword("select * from").sql(" v)");
    }
 else     if (fieldAliases != null && asList(CUBRID,FIREBIRD,SQLSERVER,SYBASE).contains(dialect) && wrapped instanceof TableImpl) {
      context.keyword("(select * from ").sql(wrapped).sql(")");
    }
 else {
      if (wrapInParentheses) {
        context.sql("(");
      }
      context.sql(wrapped);
      if (wrapInParentheses) {
        context.sql(")");
      }
    }
    if (asList(DERBY,HSQLDB,MYSQL,POSTGRES).contains(dialect)) {
      context.keyword(" as");
    }
    context.sql(" ");
    context.literal(alias);
    if (fieldAliases != null && !simulateDerivedColumnList) {
      toSQLDerivedColumnList(context);
    }
 else {
switch (dialect) {
case HSQLDB:
case POSTGRES:
{
          Object o=wrapped;
          if (context.declareTables() && o instanceof ArrayTable) {
            ArrayTable table=(ArrayTable)o;
            context.sql("(");
            Utils.fieldNames(context,table.getFields());
            context.sql(")");
          }
          break;
        }
    }
  }
}
 else {
  context.literal(alias);
}
}
