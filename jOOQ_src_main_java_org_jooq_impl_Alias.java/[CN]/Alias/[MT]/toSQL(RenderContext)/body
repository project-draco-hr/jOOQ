{
  if (context.declareFields() || context.declareTables()) {
    SQLDialect dialect=context.getDialect();
    boolean simulateDerivedColumnList=false;
    if (fieldAliases != null && asList(CUBRID,FIREBIRD,SQLSERVER,SYBASE).contains(dialect) && wrapped instanceof TableImpl) {
      context.sql("(").formatIndentStart().formatNewLine().keyword("select * from").sql(wrapped).formatIndentEnd().formatNewLine().sql(")");
    }
 else     if (fieldAliases != null && asList(H2,MYSQL,ORACLE,SQLITE).contains(dialect)) {
      simulateDerivedColumnList=true;
      FieldList fields=new SelectFieldList();
      for (      String fieldAlias : fieldAliases) {
        fields.add(field("null").as(fieldAlias));
      }
      context.sql("(").formatIndentStart().formatNewLine().keyword("select ").declareFields(true).sql(fields).declareFields(false).formatSeparator();
      if (!"".equals(new DefaultRenderContext(context).render(new Dual()))) {
        context.keyword("from ").sql(new Dual()).formatSeparator();
      }
      context.keyword("where ").sql("1 = 0").formatSeparator().keyword("union all").formatSeparator().keyword("select * from ").sql("(").sql(wrapped).sql(")").formatIndentEnd().formatNewLine().sql(")");
    }
 else {
      if (wrapInParentheses) {
        context.sql("(");
      }
      context.sql(wrapped);
      if (wrapInParentheses) {
        context.sql(")");
      }
    }
    if (asList(DERBY,HSQLDB,MYSQL,POSTGRES).contains(dialect)) {
      context.keyword(" as");
    }
    context.sql(" ");
    context.literal(alias);
    if (fieldAliases != null && !simulateDerivedColumnList) {
      toSQLDerivedColumnList(context);
    }
 else {
switch (dialect) {
case HSQLDB:
case POSTGRES:
{
          Object o=wrapped;
          if (context.declareTables() && o instanceof ArrayTable) {
            ArrayTable table=(ArrayTable)o;
            context.sql("(");
            Utils.fieldNames(context,table.getFields());
            context.sql(")");
          }
          break;
        }
    }
  }
}
 else {
  context.literal(alias);
}
}
