{
  if (!isLogging) {
    return;
  }
  endExecutionTime=System.currentTimeMillis();
  List<SqlQueryDebugger> sqlQueryDebuggerList=SqlQueryDebuggerRegister.getSqlQueryDebuggerList();
  if (sqlQueryDebuggerList.isEmpty()) {
    return;
  }
  ResultSet resultSet=ctx.resultSet();
  String[] sql=ctx.batchSQL();
  if (sql.length == 1 && sql[0] == null) {
    sql=new String[]{ctx.sql()};
  }
  SqlQueryType sqlQueryType=getSqlQueryType(sql[0]);
  if (sql.length == 1) {
    PreparedStatement statement=ctx.statement();
    if (statement instanceof UsageTrackingPreparedStatement) {
      String parameterDescription=((UsageTrackingPreparedStatement)statement).getParameterDescription();
      if (parameterDescription != null) {
        sql=new String[]{sql[0] + " -> " + parameterDescription};
      }
    }
  }
  SqlQueryDebuggerData sqlQueryDebuggerData=new SqlQueryDebuggerData(sqlQueryType,sql,startPreparationTime == 0 ? null : aggregatedPreparationDuration,startBindTime == 0 ? null : endBindTime - startBindTime,endExecutionTime - startExecutionTime);
  for (  SqlQueryDebugger listener : sqlQueryDebuggerList) {
    listener.debugQueries(sqlQueryDebuggerData);
  }
  if (resultSet != null) {
    final int sqlQueryDebuggerDataID=sqlQueryDebuggerData.getID();
    ResultSet newResultSet=new UsageTrackingResultSet(resultSet){
      @Override protected void notifyData(      long lifeTime,      int readRows,      int readCount,      int writeCount){
        List<SqlQueryDebugger> sqlQueryDebuggerList=SqlQueryDebuggerRegister.getSqlQueryDebuggerList();
        if (sqlQueryDebuggerList.isEmpty()) {
          return;
        }
        SqlQueryDebuggerResultSetData sqlQueryDebuggerResultSetData=new SqlQueryDebuggerResultSetData(lifeTime,readRows,readCount,writeCount);
        for (        SqlQueryDebugger listener : sqlQueryDebuggerList) {
          listener.debugResultSet(sqlQueryDebuggerDataID,sqlQueryDebuggerResultSetData);
        }
      }
    }
;
    ctx.resultSet(newResultSet);
  }
}
