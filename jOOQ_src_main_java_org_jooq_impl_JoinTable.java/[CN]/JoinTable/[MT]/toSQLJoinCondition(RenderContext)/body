{
  if (!using.isEmpty()) {
    if (asList(ASE,CUBRID,DB2,H2,SQLSERVER,SYBASE).contains(context.configuration().getDialect())) {
      String glue="on ";
      for (      Field<?> field : using) {
        context.formatSeparator().keyword(glue).sql(lhs.field(field)).sql(" = ").sql(rhs.field(field));
        glue="and ";
      }
    }
 else {
      context.formatSeparator().keyword("using (");
      Utils.fieldNames(context,using);
      context.sql(")");
    }
  }
 else   if (simulateNaturalJoin(context) || simulateNaturalLeftOuterJoin(context) || simulateNaturalRightOuterJoin(context)) {
    String glue="on ";
    for (    Field<?> field : lhs.fields()) {
      Field<?> other=rhs.field(field);
      if (other != null) {
        context.formatSeparator().keyword(glue).sql(field).sql(" = ").sql(other);
        glue="and ";
      }
    }
  }
 else {
    context.formatSeparator().keyword("on ").sql(condition);
  }
}
