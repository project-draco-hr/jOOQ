{
  socket=new Socket(ip,port);
  Thread thread=new Thread("SQL Remote Debugger Client on port " + port){
    @Override public void run(){
      DebuggerRegistryListener debuggerRegisterListener=null;
      try {
        final ObjectOutputStream out=new ObjectOutputStream(new BufferedOutputStream(socket.getOutputStream()));
        debuggerRegisterListener=new DebuggerRegistryListener(){
          @Override public void notifyDebuggerListenersModified(){
            try {
              boolean isLogging=!DebuggerRegistry.getDebuggerList().isEmpty();
              out.writeObject(new ServerLoggingActivationMessage(isLogging));
              out.flush();
            }
 catch (            IOException e) {
              e.printStackTrace();
            }
          }
        }
;
        DebuggerRegistry.addDebuggerRegisterListener(debuggerRegisterListener);
        ObjectInputStream in=new ObjectInputStream(new BufferedInputStream(socket.getInputStream()));
        for (Message o; (o=(Message)in.readObject()) != null; ) {
          if (o instanceof ClientDebugQueriesMessage) {
            DebuggerData sqlQueryDebuggerData=((ClientDebugQueriesMessage)o).getSqlQueryDebuggerData();
            for (            Debugger debugger : DebuggerRegistry.getDebuggerList()) {
              debugger.debugQueries(sqlQueryDebuggerData);
            }
          }
 else           if (o instanceof ClientDebugResultSetMessage) {
            ClientDebugResultSetMessage m=(ClientDebugResultSetMessage)o;
            int sqlQueryDebuggerDataID=m.getSqlQueryDebuggerDataID();
            DebuggerResultSetData clientDebugResultSetData=m.getSqlQueryDebuggerResultSetData();
            for (            Debugger debugger : DebuggerRegistry.getDebuggerList()) {
              debugger.debugResultSet(sqlQueryDebuggerDataID,clientDebugResultSetData);
            }
          }
        }
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
 finally {
        if (debuggerRegisterListener != null) {
          DebuggerRegistry.removeDebuggerRegisterListener(debuggerRegisterListener);
        }
      }
    }
  }
;
  thread.setDaemon(true);
  thread.start();
}
