{
  Connection connection=configuration.getConnection();
  boolean autoCommit=false;
  if (configuration.getDialect() == SQLDialect.POSTGRES && isSelectingRefCursor()) {
    autoCommit=connection.getAutoCommit();
    if (autoCommit) {
      connection.setAutoCommit(false);
    }
  }
  try {
    ResultSet rs=statement.executeQuery();
    FieldList fields=new FieldList(getFields(rs.getMetaData()));
    cursor=new CursorImpl<R>(configuration,fields,rs,statement,getRecordType());
    if (!lazy) {
      result=cursor.fetchResult();
      cursor=null;
    }
  }
  finally {
    if (autoCommit) {
      connection.setAutoCommit(autoCommit);
    }
  }
  return result != null ? result.size() : 0;
}
