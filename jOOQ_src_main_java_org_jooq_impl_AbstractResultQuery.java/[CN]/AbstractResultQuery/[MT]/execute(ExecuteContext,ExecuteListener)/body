{
  listener.executeStart(ctx);
  if (ctx.configuration().dialect() == ASE) {
    ctx.resultSet(ctx.statement().executeQuery());
  }
 else   if (ctx.statement().execute()) {
    ctx.resultSet(ctx.statement().getResultSet());
  }
  listener.executeEnd(ctx);
  if (!many) {
    if (ctx.resultSet() != null) {
      Field<?>[] fields=getFields(ctx.resultSet().getMetaData());
      cursor=new CursorImpl<R>(ctx,listener,fields,internIndexes(fields),keepStatement(),keepResultSet(),getRecordType());
      if (!lazy) {
        result=cursor.fetch();
        cursor=null;
      }
    }
 else {
      result=new ResultImpl<R>(ctx.configuration());
    }
  }
 else {
    results=new ArrayList<Result<Record>>();
    boolean anyResults=false;
    while (ctx.resultSet() != null) {
      anyResults=true;
      Field<?>[] fields=new MetaDataFieldProvider(ctx.configuration(),ctx.resultSet().getMetaData()).getFields();
      Cursor<Record> c=new CursorImpl<Record>(ctx,listener,fields,internIndexes(fields),true,false);
      results.add(c.fetch());
      if (ctx.statement().getMoreResults()) {
        ctx.resultSet(ctx.statement().getResultSet());
      }
 else {
        ctx.resultSet(null);
      }
    }
    if (anyResults) {
      ctx.statement().getMoreResults(Statement.CLOSE_ALL_RESULTS);
    }
  }
  return result != null ? result.size() : 0;
}
