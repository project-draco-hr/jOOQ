{
  listener.executeStart(ctx);
  if (ctx.statement().execute()) {
    ctx.resultSet(ctx.statement().getResultSet());
  }
  listener.executeEnd(ctx);
  if (!many) {
    if (ctx.resultSet() != null) {
      Field<?>[] fields=getFields(ctx.resultSet().getMetaData());
      cursor=new CursorImpl<R>(ctx,listener,fields,intern.internIndexes(fields),keepStatement(),keepResultSet(),getRecordType(),maxRows);
      if (!lazy) {
        result=cursor.fetch();
        cursor=null;
      }
    }
 else {
      result=new ResultImpl<R>(ctx.configuration());
    }
  }
 else {
    results=new ArrayList<Result<Record>>();
    consumeResultSets(ctx,listener,results,intern);
  }
  return result != null ? result.size() : 0;
}
