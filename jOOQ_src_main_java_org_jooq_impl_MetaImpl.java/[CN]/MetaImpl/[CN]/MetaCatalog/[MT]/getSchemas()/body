{
  try {
    List<Schema> result=new ArrayList<Schema>();
    if (!asList(MYSQL,MARIADB).contains(configuration.dialect().family())) {
      Result<Record> schemas=create.fetch(meta().getSchemas(),SQLDataType.VARCHAR,SQLDataType.VARCHAR);
      for (      String name : schemas.getValues(0,String.class)) {
        result.add(new MetaSchema(name));
      }
    }
 else {
      Result<Record> schemas=create.fetch(meta().getCatalogs(),SQLDataType.VARCHAR);
      for (      String name : schemas.getValues(0,String.class)) {
        result.add(new MetaSchema(name));
      }
    }
    if (result.isEmpty()) {
      result.add(new MetaSchema(""));
    }
    return result;
  }
 catch (  SQLException e) {
    throw new DataAccessException("Error while accessing DatabaseMetaData",e);
  }
}
