{
  List<Field<?>> fieldList=new ArrayList<Field<?>>();
  int columnCount=0;
  try {
    columnCount=meta.getColumnCount();
  }
 catch (  SQLException e) {
    log.warn("Cannot fetch column count for cursor : " + e.getMessage());
    fieldList.add(field("dummy"));
  }
  try {
    for (int i=1; i <= columnCount; i++) {
      String name=meta.getColumnLabel(i);
      int precision=meta.getPrecision(i);
      int scale=meta.getScale(i);
      DataType<?> dataType=SQLDataType.OTHER;
      String type=meta.getColumnTypeName(i);
      try {
        dataType=DefaultDataType.getDataType(configuration.getDialect(),type,precision,scale);
        if (dataType.hasPrecision()) {
          dataType=dataType.precision(precision);
        }
        if (dataType.hasScale()) {
          dataType=dataType.scale(scale);
        }
        if (dataType.hasLength()) {
          dataType=dataType.length(precision);
        }
      }
 catch (      SQLDialectNotSupportedException ignore) {
        log.warn("Not supported by dialect",ignore.getMessage());
      }
      fieldList.add(field(name,dataType));
    }
  }
 catch (  SQLException e) {
    throw Utils.translate(null,e);
  }
  return new Fields(fieldList);
}
