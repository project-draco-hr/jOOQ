{
  List<Field<?>> fieldList=new ArrayList<Field<?>>();
  int columnCount=0;
  try {
    columnCount=meta.getColumnCount();
  }
 catch (  SQLException e) {
    log.info("Cannot fetch column count for cursor : " + e.getMessage());
    fieldList.add(field("dummy"));
  }
  try {
    for (int i=1; i <= columnCount; i++) {
      Name name;
      String columnLabel=meta.getColumnLabel(i);
      String columnName=meta.getColumnName(i);
      if (columnName.equals(columnLabel)) {
        String columnSchema=meta.getSchemaName(i);
        String columnTable=meta.getTableName(i);
        name=name(columnSchema,columnTable,columnName);
      }
 else {
        name=name(columnLabel);
      }
      int precision=meta.getPrecision(i);
      int scale=meta.getScale(i);
      DataType<?> dataType=SQLDataType.OTHER;
      String type=meta.getColumnTypeName(i);
      try {
        dataType=DefaultDataType.getDataType(configuration.dialect().family(),type,precision,scale);
        if (dataType.hasPrecision()) {
          dataType=dataType.precision(precision);
        }
        if (dataType.hasScale()) {
          dataType=dataType.scale(scale);
        }
        if (dataType.hasLength()) {
          dataType=dataType.length(precision);
        }
      }
 catch (      SQLDialectNotSupportedException ignore) {
        log.debug("Not supported by dialect",ignore.getMessage());
      }
      fieldList.add(field(name,dataType));
    }
  }
 catch (  SQLException e) {
    throw Utils.translate(null,e);
  }
  return new Fields<Record>(fieldList);
}
