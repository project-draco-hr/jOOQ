{
  int columnCount=0;
  try {
    columnCount=meta.getColumnCount();
  }
 catch (  SQLException e) {
    log.warn("Cannot fetch column count for cursor : " + e.getMessage());
    fields.add(field("dummy"));
  }
  try {
    for (int i=1; i <= columnCount; i++) {
      String name=meta.getColumnLabel(i);
      int precision=meta.getPrecision(i);
      int scale=meta.getScale(i);
      DataType<?> dataType=SQLDataType.OTHER;
      String type=meta.getColumnTypeName(i);
      try {
        dataType=FieldTypeHelper.getDialectDataType(configuration.getDialect(),type,precision,scale);
      }
 catch (      SQLDialectNotSupportedException ignore) {
        log.warn("Not supported by dialect",ignore.getMessage());
      }
      fields.add(field(name,dataType));
    }
  }
 catch (  SQLException e) {
    throw Util.translate("MetaFieldProvider.init",null,e);
  }
  meta=null;
}
