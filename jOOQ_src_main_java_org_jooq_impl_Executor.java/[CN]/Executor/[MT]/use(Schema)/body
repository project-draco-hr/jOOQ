{
  int result=0;
  try {
    String schemaName=render(schema);
switch (getDialect()) {
case DB2:
case DERBY:
case H2:
case HSQLDB:
      result=query("set schema " + schemaName).execute();
    break;
case ASE:
case MYSQL:
case SYBASE:
  result=query("use " + schemaName).execute();
break;
case ORACLE:
result=query("alter session set current_schema = " + schemaName).execute();
break;
case POSTGRES:
result=query("set search_path = " + schemaName).execute();
break;
case SQLSERVER:
break;
case CUBRID:
case SQLITE:
break;
}
}
  finally {
getRenderMapping(getSettings()).setDefaultSchema(schema.getName());
configuration.getSchemaMapping().use(schema);
}
return result;
}
