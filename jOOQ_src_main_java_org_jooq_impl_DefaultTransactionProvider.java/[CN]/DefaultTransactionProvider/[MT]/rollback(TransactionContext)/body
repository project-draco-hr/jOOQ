{
  Stack<Savepoint> savepoints=savepoints(ctx.configuration());
  Savepoint savepoint=null;
  if (!savepoints.isEmpty())   savepoint=savepoints.pop();
  try {
    if (savepoint == null || savepoint == DUMMY_SAVEPOINT)     connection(ctx.configuration()).rollback();
 else     connection(ctx.configuration()).rollback(savepoint);
  }
  finally {
    if (savepoints.isEmpty())     brace(ctx.configuration(),false);
  }
}
