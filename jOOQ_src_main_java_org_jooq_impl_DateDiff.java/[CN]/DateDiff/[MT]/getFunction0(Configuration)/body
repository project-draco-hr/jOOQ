{
switch (configuration.getDialect()) {
case ASE:
    return function("datediff",getDataType(),literal("day"),date2,date1);
case MYSQL:
  return function("datediff",getDataType(),date1,date2);
case DB2:
return function("days",getDataType(),date1).sub(function("days",getDataType(),date2));
case DERBY:
return new FnPrefixFunction<Integer>("timestampdiff",getDataType(),field("SQL_TSI_DAY"),date2,date1);
case H2:
return function("datediff",getDataType(),literal("'day'"),date2,date1);
case CUBRID:
case ORACLE:
return date1.sub(date2).cast(Integer.class);
}
return null;
}
