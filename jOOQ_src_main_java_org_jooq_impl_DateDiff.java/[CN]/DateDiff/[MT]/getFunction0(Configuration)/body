{
switch (configuration.getDialect()) {
case ASE:
case SQLSERVER:
case SYBASE:
    return function("datediff",getDataType(),literal("day"),date2,date1);
case MYSQL:
  return function("datediff",getDataType(),date1,date2);
case DB2:
return function("days",getDataType(),date1).sub(function("days",getDataType(),date2));
case DERBY:
return field("{fn {timestampdiff}({sql_tsi_day}, {0}, {1}) }",getDataType(),date2,date1);
case H2:
case HSQLDB:
return function("datediff",getDataType(),literal("'day'"),date2,date1);
case CUBRID:
case ORACLE:
case POSTGRES:
return date1.sub(date2).cast(Integer.class);
}
return null;
}
