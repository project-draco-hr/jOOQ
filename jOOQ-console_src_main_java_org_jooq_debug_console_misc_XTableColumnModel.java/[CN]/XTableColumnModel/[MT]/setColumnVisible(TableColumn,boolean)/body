{
  if (!visible) {
    super.removeColumn(column);
  }
 else {
    int noVisibleColumns=tableColumns.size();
    int noInvisibleColumns=allTableColumns.size();
    int visibleIndex=0;
    for (int invisibleIndex=0; invisibleIndex < noInvisibleColumns; ++invisibleIndex) {
      TableColumn visibleColumn=(visibleIndex < noVisibleColumns ? (TableColumn)tableColumns.get(visibleIndex) : null);
      TableColumn testColumn=allTableColumns.get(invisibleIndex);
      if (testColumn == column) {
        if (visibleColumn != column) {
          super.addColumn(column);
          super.moveColumn(tableColumns.size() - 1,visibleIndex);
        }
        return;
      }
      if (testColumn == visibleColumn) {
        ++visibleIndex;
      }
    }
  }
}
