{
switch (dialect()) {
case ASE:
case INGRES:
case CUBRID:
case POSTGRES:
    log.info("SKIPPING","fetchInto() tests");
  return;
}
Select<?> select=create().select(TBook_ID(),TBook_TITLE(),TAuthor_FIRST_NAME(),TAuthor_LAST_NAME(),TAuthor_DATE_OF_BIRTH()).from(TBook()).join(TAuthor()).on(TBook_AUTHOR_ID().equal(TAuthor_ID())).orderBy(TBook_ID());
List<BookWithAnnotations> result1=select.fetchInto(BookWithAnnotations.class);
List<IBookWithAnnotations> result2=select.fetchInto(IBookWithAnnotations.class);
assertEquals(4,result1.size());
assertEquals(4,result2.size());
assertEquals(1,(int)result1.get(0).id);
assertEquals(2,(int)result1.get(1).id);
assertEquals(3,(int)result1.get(2).id);
assertEquals(4,(int)result1.get(3).id);
assertEquals(1,result1.get(0).id2);
assertEquals(2,result1.get(1).id2);
assertEquals(3,result1.get(2).id2);
assertEquals(4,result1.get(3).id2);
assertEquals(1,result1.get(0).id3);
assertEquals(2,result1.get(1).id3);
assertEquals(3,result1.get(2).id3);
assertEquals(4,result1.get(3).id3);
assertEquals(Long.valueOf(1),result1.get(0).id4);
assertEquals(Long.valueOf(2),result1.get(1).id4);
assertEquals(Long.valueOf(3),result1.get(2).id4);
assertEquals(Long.valueOf(4),result1.get(3).id4);
assertEquals(1L,result1.get(0).id5);
assertEquals(2L,result1.get(1).id5);
assertEquals(3L,result1.get(2).id5);
assertEquals(4L,result1.get(3).id5);
assertEquals(1,(int)result2.get(0).getId());
assertEquals(2,(int)result2.get(1).getId());
assertEquals(3,(int)result2.get(2).getId());
assertEquals(4,(int)result2.get(3).getId());
assertEquals("1984",result1.get(0).title);
assertEquals("Animal Farm",result1.get(1).title);
assertEquals("O Alquimista",result1.get(2).title);
assertEquals("Brida",result1.get(3).title);
assertEquals("George",result1.get(0).firstName);
assertEquals("George",result1.get(1).firstName);
assertEquals("Paulo",result1.get(2).firstName);
assertEquals("Paulo",result1.get(3).firstName);
assertEquals("George",result1.get(0).firstName2);
assertEquals("George",result1.get(1).firstName2);
assertEquals("Paulo",result1.get(2).firstName2);
assertEquals("Paulo",result1.get(3).firstName2);
assertEquals("Orwell",result1.get(0).lastName);
assertEquals("Orwell",result1.get(1).lastName);
assertEquals("Coelho",result1.get(2).lastName);
assertEquals("Coelho",result1.get(3).lastName);
assertEquals("Orwell",result1.get(0).lastName2);
assertEquals("Orwell",result1.get(1).lastName2);
assertEquals("Coelho",result1.get(2).lastName2);
assertEquals("Coelho",result1.get(3).lastName2);
assertEquals("Orwell",result2.get(0).getLAST_NAME());
assertEquals("Orwell",result2.get(1).getLAST_NAME());
assertEquals("Coelho",result2.get(2).getLAST_NAME());
assertEquals("Coelho",result2.get(3).getLAST_NAME());
try {
create().selectFrom(TAuthor()).fetchInto(AbstractList.class);
fail();
}
 catch (MappingException expected) {
}
create().selectFrom(TAuthor()).fetchInto(Math.class);
List<DatesWithAnnotations> calendars=create().select(TAuthor_DATE_OF_BIRTH()).from(TAuthor()).orderBy(TAuthor_ID()).fetchInto(DatesWithAnnotations.class);
assertEquals(2,calendars.size());
for (int index : asList(0,1)) {
assertEquals(calendars.get(index).cal1,calendars.get(index).cal2);
assertEquals(calendars.get(index).cal1,calendars.get(index).cal3);
assertEquals(calendars.get(index).date1,calendars.get(index).date2);
assertEquals(calendars.get(index).date1,calendars.get(index).date3);
assertEquals(calendars.get(index).long1,calendars.get(index).long2);
assertEquals(calendars.get(index).long1,calendars.get(index).long3);
assertEquals(calendars.get(index).primitiveLong1,calendars.get(index).primitiveLong2);
assertEquals(calendars.get(index).primitiveLong1,calendars.get(index).primitiveLong3);
assertEquals(calendars.get(index).cal1.getTime(),calendars.get(index).date1);
assertEquals(calendars.get(index).cal1.getTime().getTime(),calendars.get(index).date1.getTime());
assertEquals(calendars.get(index).cal1.getTime().getTime(),calendars.get(index).long1.longValue());
assertEquals(calendars.get(index).cal1.getTime().getTime(),calendars.get(index).primitiveLong1);
}
A author1=create().newRecord(TAuthor());
A author2=create().newRecord(TAuthor());
author2.setValue(TAuthor_DATE_OF_BIRTH(),new Date(1L));
DatesWithAnnotations dates1=author1.into(DatesWithAnnotations.class);
DatesWithAnnotations dates2=author2.into(DatesWithAnnotations.class);
checkDatesWithAnnotations(dates1,dates2);
DatesWithAnnotations dates3a=new DatesWithAnnotations();
DatesWithAnnotations dates4a=new DatesWithAnnotations();
DatesWithAnnotations dates3b=author1.into(dates3a);
DatesWithAnnotations dates4b=author2.into(dates4a);
assertTrue(dates3a == dates3b);
assertTrue(dates4a == dates4b);
checkDatesWithAnnotations(dates3b,dates4b);
}
