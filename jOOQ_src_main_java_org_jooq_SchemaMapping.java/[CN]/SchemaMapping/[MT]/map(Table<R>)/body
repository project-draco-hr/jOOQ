{
  if (ignoreMapping)   return table;
  Table<R> result=null;
  if (table != null) {
    Schema schema=table.getSchema();
    String schemaName=(schema == null) ? "" : schema.getName();
    String tableName=table.getName();
    String key=(schema == null || StringUtils.isEmpty(schemaName)) ? tableName : (schemaName + "." + tableName);
    if (!getTables().containsKey(key)) {
synchronized (this) {
        if (!getTables().containsKey(key)) {
          Table<R> mapped=table;
          schemaLoop:           for (          MappedSchema s : mapping().getSchemata()) {
            if (schemaName.equals(s.getInput())) {
              for (              MappedTable t : s.getTables()) {
                if (tableName.equals(t.getInput())) {
                  if (!isBlank(t.getOutput()) && !t.getOutput().equals(t.getInput())) {
                    mapped=new RenamedTable<R>(table,t.getOutput());
                  }
                  break schemaLoop;
                }
              }
            }
          }
          getTables().put(key,mapped);
        }
      }
    }
    result=(Table<R>)getTables().get(key);
  }
  return result;
}
