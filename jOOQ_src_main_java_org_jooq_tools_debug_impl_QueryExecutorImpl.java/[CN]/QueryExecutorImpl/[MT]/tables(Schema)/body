{
  schemata=(schemata != null && schemata.length > 0) ? schemata : new Schema[]{null};
  List<Table<?>> result=new ArrayList<Table<?>>();
  try {
    DatabaseMetaData meta=meta();
    for (    Schema schema : schemata) {
      String schemaName=(schema != null) ? schema.getName() : null;
      for (      Record record : create().fetch(meta.getTables(null,schemaName,null,null))) {
        result.add(tableByName(record.getValue(1,String.class),record.getValue(2,String.class)));
      }
    }
    return result.toArray(new Table[result.size()]);
  }
 catch (  SQLException e) {
    throw new DataAccessException("Cannot fetch tables",e);
  }
}
