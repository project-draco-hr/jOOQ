{
switch (dialect().family()) {
case DERBY:
case FIREBIRD:
case H2:
case MARIADB:
case MYSQL:
case SQLITE:
    log.info("SKIPPING","TRUNC(datetime) tests");
  return;
}
Calendar cal;
cal=cal(-1);
Record6<Timestamp,Timestamp,Timestamp,Timestamp,Timestamp,Timestamp> r1=create().select(DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.YEAR).as("yy"),DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.MONTH).as("mm"),DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.DAY).as("dd"),DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.HOUR).as("hh"),DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.MINUTE).as("mi"),DSL.trunc(new Timestamp(cal.getTimeInMillis()),DatePart.SECOND).as("ss")).fetchOne();
cal=cal(-1);
cal.set(Calendar.MONTH,0);
cal.set(Calendar.DAY_OF_MONTH,1);
cal.set(Calendar.HOUR_OF_DAY,0);
cal.set(Calendar.MINUTE,0);
cal.set(Calendar.SECOND,0);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value1());
cal=cal(-1);
cal.set(Calendar.DAY_OF_MONTH,1);
cal.set(Calendar.HOUR_OF_DAY,0);
cal.set(Calendar.MINUTE,0);
cal.set(Calendar.SECOND,0);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value2());
cal=cal(-1);
cal.set(Calendar.HOUR_OF_DAY,0);
cal.set(Calendar.MINUTE,0);
cal.set(Calendar.SECOND,0);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value3());
cal=cal(-1);
cal.set(Calendar.MINUTE,0);
cal.set(Calendar.SECOND,0);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value4());
cal=cal(-1);
cal.set(Calendar.SECOND,0);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value5());
cal=cal(-1);
cal.set(Calendar.MILLISECOND,0);
assertEquals(new Timestamp(cal.getTimeInMillis()),r1.value6());
}
