{
  Field<Integer> count=create().count();
  Loader<A> loader=create().loadInto(TAuthor()).loadCSV("").fields(TAuthor_ID()).execute();
  assertEquals(0,loader.processed());
  assertEquals(0,loader.errors().size());
  assertEquals(0,loader.stored());
  assertEquals(0,loader.ignored());
  assertEquals(2,(int)create().select(count).from(TAuthor()).fetchOne(count));
  loader=create().loadInto(TAuthor()).loadCSV("3\n" + "4").fields(TAuthor_ID()).ignoreRows(0).execute();
  assertEquals(1,loader.processed());
  assertEquals(1,loader.errors().size());
  assertNotNull(loader.errors().get(0));
  assertEquals(0,loader.stored());
  assertEquals(1,loader.ignored());
  assertEquals(2,(int)create().select(count).from(TAuthor()).fetchOne(count));
  loader=create().loadInto(TAuthor()).onErrorIgnore().loadCSV("3\n" + "4").fields(TAuthor_ID()).ignoreRows(0).execute();
  assertEquals(2,loader.processed());
  assertEquals(2,loader.errors().size());
  assertNotNull(loader.errors().get(0));
  assertNotNull(loader.errors().get(1));
  assertEquals(0,loader.stored());
  assertEquals(2,loader.ignored());
  assertEquals(2,(int)create().select(count).from(TAuthor()).fetchOne(count));
  loader=create().loadInto(TAuthor()).onDuplicateKeyError().onErrorAbort().loadCSV("1;'Kafka'\n" + "2;Frisch").fields(TAuthor_ID(),TAuthor_LAST_NAME()).quote('\'').separator(';').ignoreRows(0).execute();
  assertEquals(1,loader.processed());
  assertEquals(1,loader.errors().size());
  assertNotNull(loader.errors().get(0));
  assertEquals(0,loader.stored());
  assertEquals(1,loader.ignored());
  assertEquals(2,(int)create().select(count).from(TAuthor()).fetchOne(count));
  loader=create().loadInto(TAuthor()).onDuplicateKeyIgnore().onErrorAbort().loadCSV("1,\"Kafka\"\n" + "2,Frisch").fields(TAuthor_ID(),TAuthor_LAST_NAME()).ignoreRows(0).execute();
  assertEquals(2,loader.processed());
  assertEquals(0,loader.errors().size());
  assertEquals(2,loader.ignored());
  assertEquals(2,(int)create().select(count).from(TAuthor()).fetchOne(count));
  loader=create().loadInto(TAuthor()).loadCSV("####Some Data####\n" + "\"ID\",\"Last Name\"\r" + "3,Hesse\n"+ "4,Frisch").fields(TAuthor_ID(),TAuthor_LAST_NAME()).quote('"').separator(',').ignoreRows(2).execute();
  assertEquals(2,loader.processed());
  assertEquals(2,loader.stored());
  assertEquals(0,loader.ignored());
  assertEquals(0,loader.errors().size());
  assertEquals(2,(int)create().select(count).from(TAuthor()).where(TAuthor_ID().in(3,4)).and(TAuthor_LAST_NAME().in("Hesse","Frisch")).fetchOne(count));
  loader=create().loadInto(TAuthor()).loadCSV("\"ID\",\"First Name\",\"Last Name\"\r" + "5,Hermann,Hesse\n" + "6,\"Max\",Frisch").fields(TAuthor_ID(),null,TAuthor_LAST_NAME()).execute();
  assertEquals(2,loader.processed());
  assertEquals(2,loader.stored());
  assertEquals(0,loader.ignored());
  assertEquals(0,loader.errors().size());
  assertEquals(2,(int)create().select(count).from(TAuthor()).where(TAuthor_ID().in(5,6)).and(TAuthor_LAST_NAME().in("Hesse","Frisch")).fetchOne(count));
}
