{
  log.info("QUITTING");
  if (connection.getClass().getPackage().getName().contains("jtds")) {
    log.info("RUNNING","dump tran TEST with truncate_only");
    connection.createStatement().execute("dump tran TEST with truncate_only");
  }
  connection.close();
  log.info("TEST STATISTICS");
  log.info("---------------");
  int total=0;
  for (  ExecuteType type : ExecuteType.values()) {
    Integer count=TestStatisticsListener.STATISTICS.get(type);
    if (count == null)     count=0;
    total+=count;
    log.info(type.name(),count + " executions");
  }
  log.info("---------------");
  log.info("Total",total);
  log.info("");
  log.info("EXECUTE LIFECYCLE STATS");
  log.info("-----------------------");
  for (  Method m : LifecycleWatcherListener.START_COUNT.keySet()) {
    Integer starts=LifecycleWatcherListener.START_COUNT.get(m);
    Integer ends=LifecycleWatcherListener.END_COUNT.get(m);
    if (!StringUtils.equals(starts,ends)) {
      log.info("Unbalanced",String.format("(start, end): (%1$3s, %2$3s) at %3$s",starts,ends == null ? 0 : ends,m.toString().replace("public void ","").replaceAll("( throws.*)?","")));
    }
  }
  log.info("Unbalanced test: ",LifecycleWatcherListener.START_COUNT.size());
}
