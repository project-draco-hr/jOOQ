{
  if (TArrays_NUMBER_R() != null) {
    Result<Record> result;
    ArrayRecord<Integer> array=newNUMBER_R();
    result=create().select().from(table(array)).fetch();
    assertEquals(0,result.size());
    assertEquals(1,result.getFields().size());
    array.set((Integer)null);
    result=create().select().from(table(array)).fetch();
    assertEquals(1,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    array.set((Integer)null,1);
    result=create().select().from(table(array)).fetch();
    assertEquals(2,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals("1","" + result.getValue(1,0));
    array.set((Integer)null,1,2);
    result=create().select().from(table(array)).fetch();
    assertEquals(3,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals("1","" + result.getValue(1,0));
    assertEquals("2","" + result.getValue(2,0));
    array.set(2,3);
    Table<?> table=table(array);
    result=create().select(TBook_ID(),TBook_TITLE()).from(TBook()).join(table).on(table.getField(0).cast(Integer.class).equal(TBook_ID())).orderBy(TBook_ID()).fetch();
    assertEquals(2,result.size());
    assertEquals(Integer.valueOf(2),result.getValue(0,TBook_ID()));
    assertEquals(Integer.valueOf(3),result.getValue(1,TBook_ID()));
    assertEquals("Animal Farm",result.getValue(0,TBook_TITLE()));
    assertEquals("O Alquimista",result.getValue(1,TBook_TITLE()));
    result=create().select(TBook_ID(),TBook_TITLE()).from(TBook()).join(table.as("t")).on(table.as("t").getField(0).cast(Integer.class).equal(TBook_ID())).orderBy(TBook_ID()).fetch();
    assertEquals(2,result.size());
    assertEquals(Integer.valueOf(2),result.getValue(0,TBook_ID()));
    assertEquals(Integer.valueOf(3),result.getValue(1,TBook_ID()));
    assertEquals("Animal Farm",result.getValue(0,TBook_TITLE()));
    assertEquals("O Alquimista",result.getValue(1,TBook_TITLE()));
    result=create().select().from(table(FArrays1Field_R(null))).fetch();
    assertEquals(0,result.size());
    assertEquals(1,result.getFields().size());
    array=newNUMBER_R();
    result=create().select().from(table(FArrays1Field_R(val(array)))).fetch();
    assertEquals(0,result.size());
    assertEquals(1,result.getFields().size());
    array.set(null,1);
    result=create().select().from(table(FArrays1Field_R(val(array)))).fetch();
    assertEquals(2,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals("1","" + result.getValue(1,0));
    array.set(null,1,null,2);
    result=create().select().from(table(FArrays1Field_R(val(array)))).fetch();
    assertEquals(4,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals("1","" + result.getValue(1,0));
    assertEquals(null,result.getValue(2,0));
    assertEquals("2","" + result.getValue(3,0));
  }
 else   if (TArrays_NUMBER() != null) {
    Result<Record> result;
    Integer[] array=new Integer[0];
    result=create().select().from(table(new Integer[0])).fetch();
    assertEquals(0,result.size());
    assertEquals(1,result.getFields().size());
    array=new Integer[]{null};
    result=create().select().from(table(array)).fetch();
    assertEquals(1,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    array=new Integer[]{null,1};
    result=create().select().from(table(array)).fetch();
    assertEquals(2,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals(1,result.getValue(1,0));
    array=new Integer[]{null,1,2};
    result=create().select().from(table(array)).fetch();
    assertEquals(3,result.size());
    assertEquals(1,result.getFields().size());
    assertEquals(null,result.getValue(0,0));
    assertEquals(1,result.getValue(1,0));
    assertEquals(2,result.getValue(2,0));
    array=new Integer[]{2,3};
    Table<?> table=table(array);
    result=create().select(TBook_ID(),TBook_TITLE()).from(TBook()).join(table).on(table.getField(0).cast(Integer.class).equal(TBook_ID())).fetch();
    assertEquals(2,result.size());
    assertEquals(Integer.valueOf(2),result.getValue(0,TBook_ID()));
    assertEquals(Integer.valueOf(3),result.getValue(1,TBook_ID()));
    assertEquals("Animal Farm",result.getValue(0,TBook_TITLE()));
    assertEquals("O Alquimista",result.getValue(1,TBook_TITLE()));
    result=create().select(TBook_ID(),TBook_TITLE()).from(TBook()).join(table.as("t")).on(table.as("t").getField(0).cast(Integer.class).equal(TBook_ID())).fetch();
    assertEquals(2,result.size());
    assertEquals(Integer.valueOf(2),result.getValue(0,TBook_ID()));
    assertEquals(Integer.valueOf(3),result.getValue(1,TBook_ID()));
    assertEquals("Animal Farm",result.getValue(0,TBook_TITLE()));
    assertEquals("O Alquimista",result.getValue(1,TBook_TITLE()));
switch (getDialect()) {
case POSTGRES:
case H2:
      log.info("SKIPPING","Cross join of table with unnested array is not supported");
    break;
default :
  table=table(TArrays_STRING()).as("t");
result=create().select(TArrays_ID(),table.getField(0)).from(TArrays(),table).orderBy(TArrays_ID()).fetch();
assertEquals(3,result.size());
assertEquals(Integer.valueOf(3),result.getValue(0,TArrays_ID()));
assertEquals(Integer.valueOf(4),result.getValue(1,TArrays_ID()));
assertEquals(Integer.valueOf(4),result.getValue(2,TArrays_ID()));
assertEquals("a",result.getValue(0,1));
assertEquals("a",result.getValue(1,1));
assertEquals("b",result.getValue(2,1));
}
result=create().select().from(table(FArrays1Field(null))).fetch();
assertEquals(0,result.size());
assertEquals(1,result.getFields().size());
array=new Integer[0];
result=create().select().from(table(FArrays1Field(val(array)))).fetch();
assertEquals(0,result.size());
assertEquals(1,result.getFields().size());
array=new Integer[]{null,1};
result=create().select().from(table(FArrays1Field(val(array)))).fetch();
assertEquals(2,result.size());
assertEquals(1,result.getFields().size());
assertEquals(null,result.getValue(0,0));
assertEquals("1","" + result.getValue(1,0));
array=new Integer[]{null,1,null,2};
result=create().select().from(table(FArrays1Field(val(array)))).fetch();
assertEquals(4,result.size());
assertEquals(1,result.getFields().size());
assertEquals(null,result.getValue(0,0));
assertEquals("1","" + result.getValue(1,0));
assertEquals(null,result.getValue(2,0));
assertEquals("2","" + result.getValue(3,0));
}
 else {
log.info("SKIPPING","ARRAY TABLE tests");
}
}
