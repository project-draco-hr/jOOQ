{
  log.info("QUITTING");
  if (connection != null) {
    if (connection.getClass().getPackage().getName().contains("jtds") && !connection.getMetaData().getURL().contains("sqlserver")) {
      log.info("RUNNING","dump tran TEST with truncate_only");
      connection.createStatement().execute("dump tran TEST with truncate_only");
    }
    connection.close();
    connection=null;
  }
  JooqLogger logStat=JooqLogger.getLogger(TestStatisticsListener.class);
  logStat.info("TEST STATISTICS");
  logStat.info("---------------");
  int total=0;
  for (  ExecuteType type : ExecuteType.values()) {
    Integer count=TestStatisticsListener.STATISTICS.get(type);
    if (count == null)     count=0;
    total+=count;
    logStat.info(type.name(),count + " executions");
  }
  logStat.info("---------------");
  logStat.info("Total",total);
  int unbalanced=0;
  JooqLogger logLife=JooqLogger.getLogger(Lifecycle.class);
  logLife.info("");
  logLife.info("CONNECTION PROVIDER LIFECYCLE STATS");
  logLife.info("-----------------------------------");
  unbalanced=extracted(logLife,unbalanced,ACQUIRE_COUNT,RELEASE_COUNT);
  logLife.info("");
  logLife.info("EXECUTE LISTENER LIFECYCLE STATS");
  logLife.info("--------------------------------");
  unbalanced=extracted(logLife,unbalanced,LISTENER_START_COUNT,LISTENER_END_COUNT);
  logLife.info("");
  logLife.info("JDBC STATEMENT LIFECYCLE STATS");
  logLife.info("------------------------------");
  unbalanced=extracted(logLife,unbalanced,STMT_START_COUNT,STMT_CLOSE_COUNT);
  logLife.info("");
  logLife.info("JDBC RESULTSET LIFECYCLE STATS");
  logLife.info("------------------------------");
  unbalanced=extracted(logLife,unbalanced,RS_START_COUNT,RS_CLOSE_COUNT);
  logLife.info("");
  logLife.info("Unbalanced test: ",unbalanced);
}
