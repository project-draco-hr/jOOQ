{
  if (returning.isEmpty()) {
    return super.execute(configuration,statement);
  }
 else {
    int result=1;
    ResultSet rs;
switch (configuration.getDialect()) {
case SQLITE:
{
        result=statement.executeUpdate();
        SQLiteFactory create=new SQLiteFactory(configuration.getConnection());
        Field<Long> rowid=create.rowid();
        for (        Record untyped : create.select(returning).from(getInto()).where(rowid.equal(rowid.getDataType().convert(create.lastID()))).fetch()) {
          R typed=JooqUtil.newRecord(getInto(),configuration);
          for (          Field<?> field : returning) {
            setValue(field,typed,untyped);
          }
          getReturnedRecords().add(typed);
        }
        return result;
      }
case SYBASE:
{
      result=statement.executeUpdate();
      selectReturning(configuration,create(configuration).lastID());
      return result;
    }
case ASE:
case DERBY:
case H2:
case INGRES:
case MYSQL:
case SQLSERVER:
{
    result=statement.executeUpdate();
    rs=statement.getGeneratedKeys();
    try {
      List<Object> list=new ArrayList<Object>();
      while (rs.next()) {
        list.add(rs.getObject(1));
      }
      selectReturning(configuration,list.toArray());
      return result;
    }
  finally {
      rs.close();
    }
  }
case POSTGRES:
{
  rs=statement.executeQuery();
  break;
}
case DB2:
case HSQLDB:
case ORACLE:
default :
{
result=statement.executeUpdate();
rs=statement.getGeneratedKeys();
break;
}
}
CursorImpl<R> cursor=new CursorImpl<R>(configuration,returning,rs,statement,getInto().getRecordType());
returned=cursor.fetchResult();
return result;
}
}
