{
  socket=new Socket(ip,port);
  out=new ObjectOutputStream(new BufferedOutputStream(socket.getOutputStream()));
  Thread thread=new Thread("SQL Remote Debugger Client on port " + port){
    @Override public void run(){
      try {
        ObjectInputStream in=new ObjectInputStream(new BufferedInputStream(socket.getInputStream()));
        for (Message o; (o=(Message)in.readObject()) != null; ) {
          if (o instanceof ClientDebugQueriesMessage) {
            if (loggingListener != null) {
              QueryLoggingData sqlQueryDebuggerData=((ClientDebugQueriesMessage)o).getSqlQueryDebuggerData();
              loggingListener.logQueries(sqlQueryDebuggerData);
            }
          }
 else           if (o instanceof ClientDebugResultSetMessage) {
            if (loggingListener != null) {
              ClientDebugResultSetMessage m=(ClientDebugResultSetMessage)o;
              int sqlQueryDebuggerDataID=m.getSqlQueryDebuggerDataID();
              ResultSetLoggingData clientDebugResultSetData=m.getSqlQueryDebuggerResultSetData();
              loggingListener.logResultSet(sqlQueryDebuggerDataID,clientDebugResultSetData);
            }
          }
        }
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
;
  thread.setDaemon(true);
  thread.start();
}
