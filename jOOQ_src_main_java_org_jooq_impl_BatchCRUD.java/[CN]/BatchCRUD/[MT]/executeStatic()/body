{
  List<Query> queries=new ArrayList<Query>();
  QueryCollector collector=new QueryCollector();
  List<ExecuteListener> listeners=new ArrayList<ExecuteListener>(configuration.executeListenerProvider().provide());
  listeners.add(collector);
  Configuration local=configuration.derive(new DefaultExecuteListenerProvider(listeners));
  for (int i=0; i < records.length; i++) {
    Configuration previous=((AttachableInternal)records[i]).getConfiguration();
    try {
      records[i].attach(local);
      executeAction(i);
    }
 catch (    QueryCollectorException e) {
      Query query=e.getQuery();
      if (query.isExecutable()) {
        queries.add(query);
      }
    }
 finally {
      records[i].attach(previous);
    }
  }
  int[] result=create.batch(queries).execute();
  updateChangedFlag();
  return result;
}
