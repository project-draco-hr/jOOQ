{
switch (configuration.dialect().family()) {
case ASE:
case DERBY:
{
      Field<BigDecimal> power;
      Integer decimalsVal=extractVal(decimals);
      if (decimalsVal != null) {
        power=inline(TEN.pow(decimalsVal,MathContext.DECIMAL128));
      }
 else {
        power=DSL.power(inline(TEN),decimals);
      }
      return DSL.decode().when(field.sign().greaterOrEqual(zero()),field.mul(power).floor().div(power)).otherwise(field.mul(power).ceil().div(power));
    }
case H2:
case MARIADB:
case MYSQL:
  return field("{truncate}({0}, {1})",field.getDataType(),field,decimals);
case POSTGRES:
return field("{trunc}({0}, {1})",SQLDataType.NUMERIC,field.cast(BigDecimal.class),decimals).cast(field.getDataType());
case SQLSERVER:
return field("{round}({0}, {1}, {2})",field.getDataType(),field,decimals,one());
case SYBASE:
return field("{truncnum}({0}, {1})",field.getDataType(),field,decimals);
case DB2:
case INGRES:
case ORACLE:
case CUBRID:
case HSQLDB:
default :
return field("{trunc}({0}, {1})",field.getDataType(),field,decimals);
}
}
