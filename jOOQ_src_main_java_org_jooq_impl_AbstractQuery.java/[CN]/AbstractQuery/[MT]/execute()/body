{
  if (isExecutable()) {
    Configuration configuration=org.jooq.ConfigurationRegistry.provideFor(getConfiguration());
    if (configuration == null) {
      configuration=getConfiguration();
    }
    ExecuteContext ctx=new DefaultExecuteContext(configuration,this);
    ExecuteListener listener=new ExecuteListeners(ctx);
    Connection connection=configuration.getConnection();
    if (connection == null) {
      throw new DetachedException("Cannot execute query. No Connection configured");
    }
    attach(configuration);
    int result=0;
    try {
      listener.renderStart(ctx);
      ctx.sql(getSQL());
      listener.renderEnd(ctx);
      listener.prepareStart(ctx);
      prepare(ctx);
      listener.prepareEnd(ctx);
      if (executePreparedStatements(getConfiguration().getSettings())) {
        listener.bindStart(ctx);
        create(configuration).bind(this,ctx.statement());
        listener.bindEnd(ctx);
      }
      result=execute(ctx,listener);
      return result;
    }
 catch (    SQLException e) {
      ctx.sqlException(e);
      listener.exception(ctx);
      throw ctx.exception();
    }
 finally {
      if (!keepStatementOpen()) {
        Util.safeClose(listener,ctx);
      }
    }
  }
 else {
    if (log.isDebugEnabled()) {
      log.debug("Query is not executable",this);
    }
    return 0;
  }
}
