{
  try {
    create().execute("CREATE VIEW my_view AS\n{0};",select(FIRST_NAME,LAST_NAME,count().cast(Long.class).as("Books Written")).from(T_AUTHOR).join(T_BOOK).on(TAuthor.ID.eq(AUTHOR_ID)).groupBy(FIRST_NAME,LAST_NAME).orderBy(FIRST_NAME,LAST_NAME));
    Result<Record> result=create().fetch("SELECT * FROM my_view");
    assertEquals(2,result.size());
    assertEquals(AUTHOR_FIRST_NAMES,result.getValues(0));
    assertEquals(AUTHOR_LAST_NAMES,result.getValues(1));
    assertEquals(asList(2L,2L),result.getValues("Books Written"));
  }
  finally {
    create().execute("DROP VIEW my_view");
  }
}
