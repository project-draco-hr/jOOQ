{
  boolean sqlite=(dialect() == SQLITE);
  boolean ingres=(dialect() == INGRES);
  BigDecimal rand=create().select(rand()).fetchOne(rand());
  assertNotNull(rand);
  Field<Float> f1a=round(1.111f);
  Field<Float> f2a=round(1.111f,2);
  Field<Float> f3a=floor(1.111f);
  Field<Float> f4a=ceil(1.111f);
  Field<Float> f5a=sqlite || ingres ? inline(1.0f) : trunc(1.111f);
  Field<Float> f6a=sqlite || ingres ? inline(1.11f) : trunc(1.111f,2);
  Field<Float> f7a=sqlite || ingres ? inline(10.0f) : trunc(11.111f,-1);
  Field<Double> f1b=round(-1.111);
  Field<Double> f2b=round(-1.111,2);
  Field<Double> f3b=floor(-1.111);
  Field<Double> f4b=ceil(-1.111);
  Field<Double> f5b=sqlite || ingres ? inline(1.0) : trunc(1.111);
  Field<Double> f6b=sqlite || ingres ? inline(1.11) : trunc(1.111,2);
  Field<Double> f7b=sqlite || ingres ? inline(10.0) : trunc(11.111,-1);
  Field<Float> f1c=round(2.0f);
  Field<Float> f2c=round(2.0f,2);
  Field<Float> f3c=floor(2.0f);
  Field<Float> f4c=ceil(2.0f);
  Field<Double> f1d=round(-2.0);
  Field<Double> f2d=round(-2.0,2);
  Field<Double> f3d=floor(-2.0);
  Field<Double> f4d=ceil(-2.0);
  Field<Float> f1e=ingres ? inline(0.0f) : round(0.0f);
  Field<Float> f2e=ingres ? inline(0.0f) : round(0.0f,2);
  Field<Float> f3e=ingres ? inline(0.0f) : floor(0.0f);
  Field<Float> f4e=ingres ? inline(0.0f) : ceil(0.0f);
  Field<Double> f1f=round(0.0);
  Field<Double> f2f=round(0.0,2);
  Field<Double> f3f=floor(0.0);
  Field<Double> f4f=ceil(0.0);
  Record record=create().select(f1a).select(f2a,f3a).select(f4a).select(f5a,f6a,f7a).select(f1b,f2b,f3b,f4b,f6b,f6b,f7b).select(f1c,f2c,f3c,f4c).select(f1d,f2d,f3d,f4d).select(f1e,f2e,f3e,f4e).select(f1f,f2f,f3f,f4f).fetchOne();
  assertNotNull(record);
  assertEquals("1.0",record.getValue(f1a,String.class));
  assertEquals("1.11",record.getValue(f2a,String.class));
  assertEquals("1.0",record.getValue(f3a,String.class));
  assertEquals("2.0",record.getValue(f4a,String.class));
  assertEquals("1.0",record.getValue(f5a,String.class));
  assertEquals("1.11",record.getValue(f6a,String.class));
  assertEquals("10.0",record.getValue(f7a,String.class));
  assertEquals("-1.0",record.getValue(f1b,String.class));
  assertEquals("-1.11",record.getValue(f2b,String.class));
  assertEquals("-2.0",record.getValue(f3b,String.class));
  assertEquals("-1.0",record.getValue(f4b,String.class));
  assertEquals("1.0",record.getValue(f5b,String.class));
  assertEquals("1.11",record.getValue(f6b,String.class));
  assertEquals("10.0",record.getValue(f7b,String.class));
  assertEquals("2.0",record.getValue(f1c,String.class));
  assertEquals("2.0",record.getValue(f2c,String.class));
  assertEquals("2.0",record.getValue(f3c,String.class));
  assertEquals("2.0",record.getValue(f4c,String.class));
  assertEquals("-2.0",record.getValue(f1d,String.class));
  assertEquals("-2.0",record.getValue(f2d,String.class));
  assertEquals("-2.0",record.getValue(f3d,String.class));
  assertEquals("-2.0",record.getValue(f4d,String.class));
  assertEquals("0.0",record.getValue(f1e,String.class));
  assertEquals("0.0",record.getValue(f2e,String.class));
  assertEquals("0.0",record.getValue(f3e,String.class));
  assertEquals("0.0",record.getValue(f4e,String.class));
  assertEquals("0.0",record.getValue(f1f,String.class));
  assertEquals("0.0",record.getValue(f2f,String.class));
  assertEquals("0.0",record.getValue(f3f,String.class));
  assertEquals("0.0",record.getValue(f4f,String.class));
  record=create().select(greatest(1,2,3,4),least(1,2,3),greatest("1","2","3","4"),least("1","2","3")).fetchOne();
  assertEquals(Integer.valueOf(4),record.getValue(0));
  assertEquals(Integer.valueOf(1),record.getValue(1));
  assertEquals("4",record.getValue(2));
  assertEquals("1",record.getValue(3));
  Result<Record3<Integer,Integer,Integer>> result=create().select(TBook_ID(),greatest(TBook_ID(),TBook_AUTHOR_ID(),TBook_LANGUAGE_ID()),least(TBook_ID(),TBook_AUTHOR_ID(),TBook_LANGUAGE_ID())).from(TBook()).orderBy(TBook_ID()).fetch();
  assertEquals(4,result.size());
  assertEquals(BOOK_IDS,result.getValues(TBook_ID()));
  assertEquals(asList(1,2,4,4),result.getValues(1));
  assertEquals(asList(1,1,2,2),result.getValues(2));
switch (dialect()) {
case SQLITE:
    log.info("SKIPPING","Tests for mathematical functions");
  break;
default :
{
  Field<BigDecimal> m1=sqrt(2);
  Field<BigDecimal> m2=round(sqrt(4));
  Field<BigDecimal> m3=exp(2);
  Field<BigDecimal> m4=round(exp(0));
  Field<BigDecimal> m5=exp(-2);
  Field<BigDecimal> m6=ln(2);
  Field<BigDecimal> m7=round(log(16,4));
  Field<BigDecimal> m8=round(power(2,4));
  Field<BigDecimal> m9=round(power(sqrt(power(sqrt(2),2)),2));
  record=create().select(m1,m2,m3,m4,m5,m6,m7,m8,m9).fetchOne();
  assertNotNull(record);
  assertEquals("1.414",record.getValue(m1,String.class).substring(0,5));
  assertEquals("2",record.getValue(m2,String.class).substring(0,1));
  assertEquals("7.389",record.getValue(m3,String.class).substring(0,5));
  assertEquals("1",record.getValue(m4,String.class).substring(0,1));
  assertEquals("0.135",record.getValue(m5,String.class).substring(0,5));
  assertEquals("0.693",record.getValue(m6,String.class).substring(0,5));
  assertEquals("2",record.getValue(m7,String.class).substring(0,1));
  assertEquals("16",record.getValue(m8,String.class).substring(0,2));
  assertEquals("2",record.getValue(m9,String.class).substring(0,1));
  Field<BigDecimal> t1=sin(Math.PI / 6 + 0.00001);
  Field<BigDecimal> t2=cos(Math.PI / 6);
  Field<BigDecimal> t3=tan(Math.PI / 6);
  Field<BigDecimal> t4=cot(Math.PI / 6);
  Field<BigDecimal> t6=rad(deg(1.1));
  Field<BigDecimal> t7=asin(Math.PI / 6);
  Field<BigDecimal> t8=acos(Math.PI / 6);
  Field<BigDecimal> t9=atan(Math.PI / 6);
  Field<BigDecimal> ta=round(deg(atan2(1,1)));
  Field<BigDecimal> tb=sinh(1.0).div(cosh(1.0)).mul(tanh(1.0)).mul(power(coth(1.0),2).add(0.1));
  record=create().select(t1,t2,t3,t4,t6,t7,t8,t9,ta,tb).fetchOne();
  assertNotNull(record);
  assertEquals("0.5",record.getValue(t1,String.class).substring(0,3));
  assertEquals("0.866",record.getValue(t2,String.class).substring(0,5));
  assertEquals("0.577",record.getValue(t3,String.class).substring(0,5));
  assertEquals("1.732",record.getValue(t4,String.class).substring(0,5));
  assertEquals("1",record.getValue(t6,String.class).substring(0,1));
  assertEquals("0.551",record.getValue(t7,String.class).substring(0,5));
  assertEquals("1.019",record.getValue(t8,String.class).substring(0,5));
  assertEquals("0.482",record.getValue(t9,String.class).substring(0,5));
  assertEquals("45",record.getValue(ta,String.class).substring(0,2));
  assertEquals("1",record.getValue(tb,String.class).substring(0,1));
  break;
}
}
record=create().select(sign(2),sign(1),sign(0),sign(-1),sign(-2)).fetchOne();
assertNotNull(record);
assertEquals(Integer.valueOf(1),record.getValue(0));
assertEquals(Integer.valueOf(1),record.getValue(1));
assertEquals(Integer.valueOf(0),record.getValue(2));
assertEquals(Integer.valueOf(-1),record.getValue(3));
assertEquals(Integer.valueOf(-1),record.getValue(4));
record=create().select(abs(2),abs(1),abs(0),abs(-1),abs(-2)).fetchOne();
assertNotNull(record);
assertEquals(Integer.valueOf(2),record.getValue(0));
assertEquals(Integer.valueOf(1),record.getValue(1));
assertEquals(Integer.valueOf(0),record.getValue(2));
assertEquals(Integer.valueOf(1),record.getValue(3));
assertEquals(Integer.valueOf(2),record.getValue(4));
}
