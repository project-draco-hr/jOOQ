{
switch (configuration.getDialect()) {
case SQLITE:
switch (datePart) {
case YEAR:
      return function("strftime",SQLDataType.INTEGER,val("%Y"),field);
case MONTH:
    return function("strftime",SQLDataType.INTEGER,val("%m"),field);
case DAY:
  return function("strftime",SQLDataType.INTEGER,val("%d"),field);
case HOUR:
return function("strftime",SQLDataType.INTEGER,val("%H"),field);
case MINUTE:
return function("strftime",SQLDataType.INTEGER,val("%M"),field);
case SECOND:
return function("strftime",SQLDataType.INTEGER,val("%S"),field);
default :
throw new SQLDialectNotSupportedException("DatePart not supported: " + datePart);
}
case DERBY:
case DB2:
switch (datePart) {
case YEAR:
return function("year",SQLDataType.INTEGER,field);
case MONTH:
return function("month",SQLDataType.INTEGER,field);
case DAY:
return function("day",SQLDataType.INTEGER,field);
case HOUR:
return function("hour",SQLDataType.INTEGER,field);
case MINUTE:
return function("minute",SQLDataType.INTEGER,field);
case SECOND:
return function("second",SQLDataType.INTEGER,field);
default :
throw new SQLDialectNotSupportedException("DatePart not supported: " + datePart);
}
case ORACLE:
switch (datePart) {
case YEAR:
return function("to_char",SQLDataType.INTEGER,field,val("YYYY"));
case MONTH:
return function("to_char",SQLDataType.INTEGER,field,val("MM"));
case DAY:
return function("to_char",SQLDataType.INTEGER,field,val("DD"));
case HOUR:
return function("to_char",SQLDataType.INTEGER,field,val("HH24"));
case MINUTE:
return function("to_char",SQLDataType.INTEGER,field,val("MI"));
case SECOND:
return function("to_char",SQLDataType.INTEGER,field,val("SS"));
default :
throw new SQLDialectNotSupportedException("DatePart not supported: " + datePart);
}
case ASE:
case SQLSERVER:
case SYBASE:
switch (datePart) {
case YEAR:
return function("datepart",SQLDataType.INTEGER,field("yy"),field);
case MONTH:
return function("datepart",SQLDataType.INTEGER,field("mm"),field);
case DAY:
return function("datepart",SQLDataType.INTEGER,field("dd"),field);
case HOUR:
return function("datepart",SQLDataType.INTEGER,field("hh"),field);
case MINUTE:
return function("datepart",SQLDataType.INTEGER,field("mi"),field);
case SECOND:
return function("datepart",SQLDataType.INTEGER,field("ss"),field);
default :
throw new SQLDialectNotSupportedException("DatePart not supported: " + datePart);
}
case INGRES:
case MYSQL:
case POSTGRES:
case HSQLDB:
case H2:
default :
return new SQLExtract();
}
}
