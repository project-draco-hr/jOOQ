{
  if (!hasDebuggers) {
    return;
  }
  endExecutionTime=System.currentTimeMillis();
  List<Debugger> debuggerList=DebuggerRegistry.get();
  if (!debuggerList.isEmpty()) {
    boolean hasListener=false;
    for (    Debugger debugger : debuggerList) {
      LoggingListener loggingListener=debugger.getLoggingListener();
      if (loggingListener != null) {
        hasListener=true;
        break;
      }
    }
    if (hasListener) {
      String[] sql=ctx.batchSQL();
      QueryType queryType=QueryType.detectType(sql[0]);
      String parameterDescription=null;
      if (sql.length == 1) {
        PreparedStatement statement=ctx.statement();
        if (statement instanceof TrackingPreparedStatement) {
          parameterDescription=((TrackingPreparedStatement)statement).getParameterDescription();
        }
      }
      QueryInfo queryInfo=new QueryInfo(queryType,sql,parameterDescription);
      final QueryLog queryLog=new QueryLog(queryInfo,startPreparationTime == 0 ? null : aggregatedPreparationDuration,startBindTime == 0 ? null : endBindTime - startBindTime,endExecutionTime - startExecutionTime);
      final List<LoggingListener> loggingListenerList=new ArrayList<LoggingListener>(debuggerList.size());
      for (      Debugger listener : debuggerList) {
        LoggingListener loggingListener=listener.getLoggingListener();
        if (loggingListener != null) {
          QueryMatcher[] loggingStatementMatchers=listener.getLoggingStatementMatchers();
          if (loggingStatementMatchers == null) {
            loggingListenerList.add(loggingListener);
            loggingListener.logQuery(queryLog);
          }
 else           for (          QueryMatcher queryMatcher : loggingStatementMatchers) {
            if (queryMatcher.matches(queryLog.getQueryInfo())) {
              loggingListenerList.add(loggingListener);
              loggingListener.logQuery(queryLog);
              break;
            }
          }
        }
      }
      ResultSet resultSet=ctx.resultSet();
      if (resultSet != null && !loggingListenerList.isEmpty()) {
        ResultSet newResultSet=new TrackingResultSet(resultSet){
          @Override protected void notifyData(          long lifeTime,          int readRows,          int readCount,          int writeCount){
            ResultLog resultLog=null;
            for (            LoggingListener loggingListener : loggingListenerList) {
              if (resultLog == null) {
                resultLog=new ResultLog(queryLog.getID(),lifeTime,readRows,readCount,writeCount);
              }
              loggingListener.logResult(resultLog);
            }
          }
        }
;
        ctx.resultSet(newResultSet);
      }
    }
  }
  if (matchingDebugger != null) {
    Thread currentThread=Thread.currentThread();
    long threadID=currentThread.getId();
    String threadName=currentThread.getName();
    StackTraceElement[] callerStackTraceElements=currentThread.getStackTrace();
    callerStackTraceElements=Arrays.copyOfRange(callerStackTraceElements,2,callerStackTraceElements.length);
    matchingDebugger.processBreakpointAfterExecutionHit(ctx,new BreakpointHit(matchingBreakpoint.getID(),effectiveSQL,matchingParameterDescription,threadID,threadName,callerStackTraceElements,false));
  }
  if (matchingBreakpoint != null) {
    QueryProcessor afterExecutionProcessor=matchingBreakpoint.getAfterExecutionProcessor();
    matchingBreakpoint=null;
    if (afterExecutionProcessor != null) {
      String sql=afterExecutionProcessor.processSQL(matchingSQL);
      long subStartExecutionTime=System.currentTimeMillis();
      executeSQL(ctx,sql);
      long subEndExecutionTime=System.currentTimeMillis();
      for (      Debugger listener : debuggerList) {
        LoggingListener loggingListener=listener.getLoggingListener();
        if (loggingListener != null) {
          QueryType queryType=QueryType.detectType(sql);
          QueryInfo queryInfo=new QueryInfo(queryType,new String[]{sql},null);
          QueryLog queryLog=new QueryLog(queryInfo,null,null,subEndExecutionTime - subStartExecutionTime);
          QueryMatcher[] loggingStatementMatchers=listener.getLoggingStatementMatchers();
          if (loggingStatementMatchers == null) {
            loggingListener.logQuery(queryLog);
          }
 else           for (          QueryMatcher queryMatcher : loggingStatementMatchers) {
            if (queryMatcher.matches(queryLog.getQueryInfo())) {
              loggingListener.logQuery(queryLog);
              break;
            }
          }
        }
      }
    }
  }
}
