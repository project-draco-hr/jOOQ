{
  DSLContext create=create(new KeepStatementListener());
  KeepStatementListener.reset();
  ResultQuery<Record2<Integer,Integer>> query=create.select(val(1),inline(2));
  assertEquals(1,query.fetchOne(0));
  assertEquals(2,query.bind(1,2).fetchOne(0));
  assertEquals(2,KeepStatementListener.statements.size());
  assertTrue(KeepStatementListener.closed > 0);
  assertFalse(KeepStatementListener.statements.get(0) == KeepStatementListener.statements.get(1));
  KeepStatementListener.reset();
  query.keepStatement(true);
  assertEquals(2,query.fetchOne(0));
  assertEquals(3,query.bind(1,3).fetchOne(0));
  Cursor<Record2<Integer,Integer>> cursor=query.fetchLazy();
  assertEquals(3,cursor.fetchOne().getValue(0));
  assertEquals(3,query.fetchOne(0));
  assertEquals(4,KeepStatementListener.statements.size());
  assertEquals(0,KeepStatementListener.closed);
  assertEquals(create().configuration().settings().getStatementType() == StatementType.PREPARED_STATEMENT,KeepStatementListener.statements.get(0) == KeepStatementListener.statements.get(1));
  assertTrue(KeepStatementListener.statements.get(1) == KeepStatementListener.statements.get(2));
  assertTrue(KeepStatementListener.statements.get(2) == KeepStatementListener.statements.get(3));
  KeepStatementListener.reset();
  assertEquals(3,query.fetchOne(0));
  assertEquals(3,query.bind(2,4).fetchOne(0));
  assertEquals(4,query.bind(2,4).fetchOne(1));
  assertEquals(3,KeepStatementListener.statements.size());
  assertEquals(0,KeepStatementListener.closed);
  assertTrue(KeepStatementListener.statements.get(0) != KeepStatementListener.statements.get(1));
  assertTrue(KeepStatementListener.statements.get(1) != KeepStatementListener.statements.get(2));
  cursor.close();
  query.close();
}
