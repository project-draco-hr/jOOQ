{
  ResultSet rs=null;
  try {
    rs=statement.executeQuery();
    ResultSetMetaData meta=rs.getMetaData();
    MetaDataFieldProvider provider=new MetaDataFieldProvider(configuration,meta);
    for (    Field<?> field : provider.getFields()) {
      addField(field.getName(),field.getDataType());
    }
    if (log.isDebugEnabled()) {
      log.debug("Describing table",table + " with fields " + table.getFields());
    }
  }
  finally {
    JooqUtil.safeClose(rs);
  }
  return 0;
}
