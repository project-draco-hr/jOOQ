{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  copyLarge(in,out);
  String xml=out.toString();
  String xsd="/xsd/jooq-codegen-3.3.0.xsd";
  xml=xml.replaceAll("<(\\w+:)?configuration xmlns(:\\w+)?=\"http://www.jooq.org/xsd/jooq-codegen-\\d+\\.\\d+\\.\\d+.xsd\">","<$1configuration xmlns$2=\"http://www.jooq.org" + xsd + "\">");
  xml=xml.replace("<configuration>","<configuration xmlns=\"http://www.jooq.org" + xsd + "\">");
  try {
    SchemaFactory sf=SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
    javax.xml.validation.Schema schema=sf.newSchema(GenerationTool.class.getResource(xsd));
    JAXBContext ctx=JAXBContext.newInstance(Configuration.class);
    Unmarshaller unmarshaller=ctx.createUnmarshaller();
    unmarshaller.setSchema(schema);
    unmarshaller.setEventHandler(new ValidationEventHandler(){
      @Override public boolean handleEvent(      ValidationEvent event){
        log.warn("Unmarshal warning",event.getMessage());
        return true;
      }
    }
);
    return (Configuration)unmarshaller.unmarshal(new StringReader(xml));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
