{
  if (TBookSale() == null) {
    log.info("SKIPPING","Multi-schema query tests");
    return;
  }
  jOOQAbstractTest.reset=false;
  assertEquals(0,create().selectCount().from(TBookSale()).fetchOne(0));
  BS sale=create().newRecord(TBookSale());
  sale.setValue(TBookSale_ID(),1);
  sale.setValue(TBookSale_BOOK_ID(),1);
  sale.setValue(TBookSale_BOOK_STORE_NAME(),"Orell F??ssli");
  sale.setValue(TBookSale_SOLD_AT(),new Date(0));
  sale.setValue(TBookSale_SOLD_FOR(),new BigDecimal("3.50"));
  assertEquals(1,sale.store());
  assertEquals(1,create().selectCount().from(TBookSale()).fetchOne(0));
  sale=sale.copy();
  sale.setValue(TBookSale_ID(),2);
  sale.setValue(TBookSale_SOLD_FOR(),new BigDecimal("7.50"));
  assertEquals(1,sale.store());
  assertEquals(2,create().selectCount().from(TBookSale()).fetchOne(0));
  sale=sale.copy();
  sale.setValue(TBookSale_ID(),3);
  sale.setValue(TBookSale_BOOK_STORE_NAME(),"Ex Libris");
  sale.setValue(TBookSale_SOLD_FOR(),new BigDecimal("8.50"));
  assertEquals(1,sale.store());
  assertEquals(3,create().selectCount().from(TBookSale()).fetchOne(0));
  Result<Record> result1=create().select(TBook_TITLE(),TBookSale_BOOK_STORE_NAME(),sum(TBookSale_SOLD_FOR())).from(TBook().join(TBookSale()).on(TBook_ID().equal(TBookSale_BOOK_ID()))).groupBy(TBook_ID(),TBook_TITLE(),TBookSale_BOOK_STORE_NAME()).orderBy(TBook_ID().asc(),sum(TBookSale_SOLD_FOR()).desc()).fetch();
  assertEquals(2,result1.size());
  assertEquals(nCopies(2,"1984"),result1.getValues(TBook_TITLE()));
  assertEquals(asList("Orell F??ssli","Ex Libris"),result1.getValues(TBookSale_BOOK_STORE_NAME()));
  assertEquals(asList(new BigDecimal("11"),new BigDecimal("8.5")),result1.getValues(sum(TBookSale_SOLD_FOR())));
  Result<Record> result2=create().select(TBook_TITLE(),TBookSale_BOOK_STORE_NAME(),sum(TBookSale_SOLD_FOR())).from(TBook().join(TBookToBookStore().join(TBookSale()).onKey()).onKey()).groupBy(TBook_ID(),TBook_TITLE(),TBookSale_BOOK_STORE_NAME()).orderBy(TBook_ID().asc(),sum(TBookSale_SOLD_FOR()).desc()).fetch();
  assertEquals(result1,result2);
}
