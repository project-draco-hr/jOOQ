{
  List<Query> queries=new ArrayList<Query>();
  for (  Table<?> table : schema.getTables()) {
    List<Constraint> constraints=new ArrayList<Constraint>();
    for (    UniqueKey<?> key : table.getKeys())     if (key.isPrimary())     constraints.add(constraint(key.getName()).primaryKey(key.getFieldsArray()));
 else     constraints.add(constraint(key.getName()).unique(key.getFieldsArray()));
    queries.add(ctx.createTable(table).columns(table.fields()).constraints(constraints));
  }
  for (  Table<?> table : schema.getTables())   for (  ForeignKey<?,?> key : table.getReferences())   queries.add(ctx.alterTable(table).add(constraint(key.getName()).foreignKey(key.getFieldsArray()).references(key.getKey().getTable(),key.getKey().getFieldsArray())));
  return DSL.queries(queries);
}
