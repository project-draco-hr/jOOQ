{
  int result=0;
  try {
    String schemaName=render(schema);
switch (dialect) {
case DB2:
case DERBY:
case H2:
case HSQLDB:
      result=query("set schema " + schemaName).execute();
    break;
case ASE:
case MYSQL:
case SYBASE:
  result=query("use " + schemaName).execute();
break;
case ORACLE:
result=query("alter session set current_schema = " + schemaName).execute();
break;
case POSTGRES:
result=query("set search_path = " + schemaName).execute();
break;
case SQLSERVER:
break;
case SQLITE:
break;
}
}
  finally {
getRenderMapping(settings).setDefaultSchema(schema.getName());
mapping.use(mapping.map(schema));
}
return result;
}
